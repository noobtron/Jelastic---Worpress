{
    "jpsVersion": "0.3",
    "jpsType": "install",
    "application": {
        "id": "Wordpress - latest",
        "name": "Wordpress - latest",
        "version": "latest",
        "categories" : [
            "apps/blogs"
        ,"apps/content-management"],
        "logo": "https://download.jelastic.com/public.php?service=files&t=3da2215839f82aa50d3d961271cd1cb9&download",
        "type": "php",
        "homepage": "http://wordpress.org/",
        "description": {
            "text": "WordPress is web software you can use to create a beautiful website or blog. We like to say that WordPress is both free and priceless at the same time."
        },
        "env": {
            "topology": {
                "ha": false,
                "engine": "php7.0",
                "ssl": false,
                "nodes": [
                    {
                        "extip": false,
                        "count": 1,
                        "cloudlets": 16,
                        "nodeType": "nginxphp"
                    },
                    {
                        "nodeType": "mariadb10",
                        "extip": false,
                        "count": 1,
                        "cloudlets": 16
                    }
                ]
            },
            "deployments": [
                {
                    "archive": "https://owncloud.sylvesteri.fi/owncloud/index.php/s/HSqj7WrIKjiymZZ/download",
                    "name": "wordpress-4.6.1.zip",
                    "context": "ROOT"
                }
            ],
            "configs": [
                {
					"prepareSqlDatabase": [
						{
							"nodeType": "mariadb10",
							"loginCredentials": {
								"user": "root",
								"password": "${nodes.sqldb.password}"
							},
							"newDatabaseName": "${nodes.mariadb10.database.name}",
							"newDatabaseUser": {
								"name": "wp-db",
								"password": "${nodes.mariadb10.database.password}"
							}
						}
					]
				},
				{
                    "nodeType": "nginxphp",
                    "path": "${SERVER_WEBROOT}/ROOT/wp-config.php",
                    "replacements": [
                        {
                            "pattern": "database_name_here",
                            "replacement": "wordpress"
                        },
                        {
                            "pattern": "username_here",
                            "replacement": "wp-db"
                        },
                        {
                            "pattern": "password_here",
                            "replacement": "${nodes.mariadb10.database.password}"
                        },
                        {
                            "pattern": "localhost",
                            "replacement": "${nodes.mariadb10.url}"
                        }
                    ]
                },
                {
                    "nodeType": "nginxphp",
                    "path": "/etc/nginx/nginx.conf",
                    "replacements": [
                        {
                            "pattern": "index  index.html index.htm index.php;",
                            "replacement": "index  index.html index.htm index.php;\n            try_files $uri $uri/ /index.php?$args;"
                        }
                    ]
                },
    			{
                    "restartNodes": [
                        {
                            "nodeGroup": "sqldb"
                        }
                    ]
                },
                {
                    "restartNodes": [
                        {
                            "nodeGroup": "cp"
                        }
                    ]
                }
            ]
        },
        "success": {
            "text": "Below you will find your admin panel link, username and password.</br></br> <table style='font-size:13px; border: none;'><tr><td>Admin panel URL:</td><td style='padding-left: 10px;'><a href='${env.protocol}://${env.domain}/wp-admin/' target='_blank'>${env.protocol}://${env.domain}/wp-admin/</a></td></tr>  <tr><td>Admin name:</td><td style='padding-left: 10px;'>admin</td></tr><tr><td>Password:</td><td style='padding-left: 10px;'>${user.appPassword}</td></tr></table></br>To add custom domain name for your Wordpress installation follow the steps described in our <a href='http://docs.jelastic.com/custom-domains' target='_blank'>documentation</a>"
        }
    }
}
